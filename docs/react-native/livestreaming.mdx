---
sidebar_position: 9
title: "Livestreaming"
description: "How to use Fishjam for livestreaming"
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import ConfigurePermissions from "./_components/configure-permissions.mdx";

# Livestreaming

## How to start streaming?

If your case involves streaming live audio and/or video one-to-many with low latency, Fishjam provides the exact tools you need. This scenario is 20% cheaper than videoconferencing.
First, you need to create a room of a special type `broadcaster`.

As the streaming is one-to-many, you can have only one streaming participant in that room.  
To start streaming, simply use a peer token to [join the room as you would normally do](/react-native/connecting).

## How to receive the stream?

Fishjam SDK provides a [`useLivestream`](/api/mobile/functions/useLivestream) hook to receive the broadcasted stream.
In order to use it, you need to generate a viewer token using our Server SDKs (Room Manager also provides this functionality as an example).
The `useLivestream` hook will handle the process of receiving the stream and will forward it to `LivestreamView`.

:::info

This guide assumes you already finished either the [Quick Setup](/react-native/quick-setup) or [Installation](/react-native/installation) guide.

:::

You can also use Fishjam to livestream your content to users.

In order to do this you need to create two flows.

1. The first flow will be used to broadcast the content.
2. The second flow will be used to receive the livestream.

## Broadcasting Example

<details>
<summary>Configure permissions before livestreaming</summary>

<ConfigurePermissions />

</details>

Here is an example of a very simple livestreamer that immediately livestreams the front camera to all users in a room:

```tsx
import { useEffect } from "react";
import {
  useCamera,
  useConnection,
  VideoPreviewView,
} from "@fishjam-cloud/react-native-client";

const ROOM_MANAGER_ID = "";

export default function Streamer() {
  const { prepareCamera } = useCamera();
  const { joinRoom, leaveRoom } = useConnection();

  useEffect(() => {
    const startStreaming = async () => {
      console.log("Getting room details...");
      const { url, peerToken } = await getRoomDetails(
        "TestRoom",
        "StreamerUserName",
      );

      console.log("Preparing camera...");
      await prepareCamera({ cameraEnabled: true });

      await joinRoom({ url, peerToken });
      console.log("Streaming...");
    };

    startStreaming();
    return () => {
      leaveRoom();
    };
  }, [prepareCamera, joinRoom, leaveRoom]);

  return (
    <VideoPreviewView
      style={{ width: "90%", aspectRatio: 1, alignSelf: "center" }}
    />
  );
}

async function getRoomDetails(roomName: string, peerName: string) {
  // This will work ONLY for the Sandbox App
  const response = await fetch(
    `https://fishjam.io/api/v1/connect/${ROOM_MANAGER_ID}/room-manager/?roomName=${roomName}&peerName=${peerName}&roomType=broadcaster`,
  );
  return response.json();
}
```

## Receiving the stream

Here is an example of a very simple receiver that receives the livestream:

```tsx
import { useCallback, useEffect } from "react";
import { View } from "react-native";
import {
  useLivestream,
  LivestreamView,
} from "@fishjam-cloud/react-native-client";

const YOUR_APP_ID = "";
const YOUR_BROADCASTER_ID = "";

export function Receiver() {
  const { connect, disconnect } = useLivestream();

  const handleConnect = useCallback(async () => {
    try {
      console.log("Getting stream details...");
      const { token } = await getViewerToken("TestRoom");
      await connect(
        `https://fishjam.io/api/v1/connect/${YOUR_BROADCASTER_ID}`,
        token,
      );
      console.log("Receiving...");
    } catch (err) {
      console.log(err);
    }
  }, [connect]);

  useEffect(() => {
    handleConnect();

    return () => {
      disconnect();
    };
  }, [handleConnect, disconnect]);

  return (
    <View style={{ flex: 1, justifyContent: "center", alignItems: "center" }}>
      <LivestreamView
        style={{ width: "90%", aspectRatio: 1, backgroundColor: "black" }}
      />
    </View>
  );
}

async function getViewerToken(roomName: string) {
  // This will work ONLY for the Sandbox App
  const response = await fetch(
    `https://fishjam.io/api/v1/connect/${YOUR_APP_ID}/room-manager/${roomName}/broadcast-viewer-token`,
  );
  return response.json();
}
```
