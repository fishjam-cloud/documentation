---
sidebar_position: 7
---

# Metadata

Alongside with Video and Audio, it also possible to send additional metadata with each peer. Metadata is just
JSON that could contain additional information. Most common usage is to send user name associated with track.
But it can be also used to send camera type, application information etc.

:::info

You can also set metadata on [server side, when adding user to the room](/production/server#metadata). These metadata can be defined only when user is joining room and can't be
update later. Neither by server nor client SDK. They can be used to add information that can't be overwritten, like information about real user name
or basic permission info.

:::

## Setting metadata when joining room

The `joinRoom` method from `useConnection` hook has `peerMetadata` parameter, that can be used to set object with metadata. You can also add your
custom type, to define shape of metadata.

```tsx
import { useConnection } from "@fishjam-cloud/react-client";
import { useCallback } from "react";

type PeerMetadata = {
  displayName: string;
};

export function JoinRoomButton() {
  // highlight-next-line
  const { joinRoom } = useConnection();

  const onJoinRoomPress = useCallback(async () => {
    await joinRoom<PeerMetadata>({
      peerToken: PEER_TOKEN,
      url: FISHJAM_URL,
      // highlight-next-line
      peerMetadata: { displayName: "John Wick" },
    });
  }, [joinRoom]);

  return <button onClick={onJoinRoomPress}>Join room</button>;
}
```

## Updating metadata during connection

Once you've joined the room, you can update peer metadata with `updatePeerMetadata` from `useUpdatePeerMetadata`:

```tsx
import { useUpdatePeerMetadata } from "@fishjam-cloud/react-client";
import { useCallback } from "react";

type PeerMetadata = {
  displayName: string;
};

export function JoinRoomButton() {
  // highlight-next-line
  const { updatePeerMetadata } = useUpdatePeerMetadata<PeerMetadata>();

  const onPressUpdateName = useCallback(async () => {
    // highlight-next-line
    await updatePeerMetadata({ displayName: "Thomas A. Anderson" });
  }, [updatePeerMetadata]);

  return <button onClick={onPressUpdateName}>Change name</button>;
}
```

## Reading metadata

Peer metadata are available as `metadata` property for each peer. When you list peers with `usePeers` hook, you can also read
metadata associated with it. Note that `metadata.peer` property contains metadata set by client SDK (as in above examples).
And `metadata.server` data are set with server SDK as [described here](/production/server#metadata).

```tsx
import { usePeers } from "@fishjam-cloud/react-client";

type PeerMetadata = {
  displayName: string;
};

type ServerMetadata = {
  realName: string;
};

export function ListAllNames() {
  // highlight-next-line
  const { remotePeers } = usePeers<PeerMetadata, ServerMetadata>();

  return (
    <div>
      {remotePeers.map((peer) => (
        // highlight-start
        <span>
          Display name: {peer.metadata?.peer.displayName}
          <br />
          Real name: {peer.metadata?.server.realName}
        </span>
        // highlight-end
      ))}
    </div>
  );
}
```
